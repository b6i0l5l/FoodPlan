{"ast":null,"code":"var _jsxFileName = \"/Users/wan/foodplan/src/App.js\";\nimport React, { Component } from \"react\";\nimport MicIcon from '@material-ui/icons/Mic';\nimport $ from 'jquery';\nimport logo from \"./logo.svg\";\nimport './App.css'; //------------------------SPEECH RECOGNITION-----------------------------\n\nconst SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition;\nconst recognition = new SpeechRecognition();\nrecognition.continous = true;\nrecognition.interimResults = true;\nrecognition.lang = 'zh-TW'; //------------------------COMPONENT-----------------------------\n\nclass Speech extends Component {\n  constructor() {\n    super();\n    this.state = {\n      listening: false,\n      showlistening: \"Power Off\",\n      microphone: \"red\",\n      bgcolor: '#282c34',\n      time: new Date().toLocaleString(),\n      testbutton: \"red\"\n    };\n    this.toggleListen = this.toggleListen.bind(this);\n    this.handleListen = this.handleListen.bind(this);\n  }\n\n  componentDidMount() {\n    this.intervalID = setInterval(() => this.tick(), 1000);\n  }\n\n  toggleListen() {\n    this.setState({\n      listening: !this.state.listening\n    }, this.handleListen);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.intervalID);\n  }\n\n  tick() {\n    this.setState({\n      time: new Date().toLocaleString()\n    });\n  }\n\n  handleListen() {\n    console.log('listening?', this.state.listening);\n\n    if (this.state.listening) {\n      recognition.start();\n\n      recognition.onend = () => {\n        console.log(\"...continue listening...\");\n        recognition.start();\n      };\n    } else {\n      recognition.stop();\n\n      recognition.onend = () => {\n        this.setState({\n          microphone: \"red\"\n        });\n        console.log(\"Stopped listening per click\");\n      };\n    }\n\n    recognition.onstart = () => {\n      console.log(\"Listening!\");\n      this.setState({\n        bgcolor: '#282c34',\n        microphone: \"green\"\n      });\n    };\n\n    let intermiTranscript = '';\n\n    recognition.onresult = event => {\n      let finalTranscript = '';\n\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        const transcript = event.results[i][0].transcript;\n        if (event.results[i].isFinal) intermiTranscript += transcript + ' ';else finalTranscript += transcript;\n      }\n\n      console.log(finalTranscript);\n\n      if (finalTranscript === \"打開電源\") {\n        console.log(\"指令成功！\");\n        this.setState({\n          bgcolor: '#006400',\n          showlistening: \"Power On\"\n        });\n        $.ajax({\n          url: \"https://maker.ifttt.com/trigger/ricecookeron/with/key/dyMeTmyKz4_uQNNPyqZABx\",\n          dataType: 'JSONP',\n          jsonpCallback: 'callback',\n          data: {\n            \"value1\": \"rice cooker on\"\n          },\n          success: function (result) {\n            alert(result);\n          }\n        });\n      } else if (finalTranscript === \"關掉電源\") {\n        console.log(\"指令成功！\");\n        this.setState({\n          bgcolor: '#006400',\n          showlistening: \"Power Off\"\n        });\n        $.ajax({\n          url: \"https://maker.ifttt.com/trigger/ricecookeroff/with/key/dyMeTmyKz4_uQNNPyqZABx\",\n          dataType: 'JSONP',\n          jsonpCallback: 'callback',\n          data: {\n            \"value1\": \"rice cooker off\"\n          },\n          success: function (result) {\n            alert(result);\n          }\n        });\n      }\n\n      document.getElementById('final').innerHTML = finalTranscript; //-------------------------COMMANDS------------------------------------\n\n      const transcriptArr = finalTranscript.split('OKOKOK ');\n      const stopCmd = transcriptArr.slice(-3, -1);\n      console.log('stopCmd', stopCmd);\n\n      if (stopCmd[0] === 'stop' && stopCmd[1] === 'listening') {\n        setTimeout(recognition.stop(), 8000);\n\n        recognition.onend = () => {\n          console.log('Stopped listening per command');\n          const finalText = transcriptArr.slice(0, -3).join(' ');\n          document.getElementById('final').innerHTML = finalText;\n        };\n      }\n    }; //-----------------------------------------------------------------------\n\n\n    recognition.onerror = event => {\n      console.log(\"Error occurred in recognition: \" + event.error);\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      className: \"App-header\",\n      style: {\n        backgroundColor: this.state.bgcolor\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"listening\",\n      className: \"listening\",\n      style: {\n        position: \"absolute\",\n        top: 10,\n        left: 10\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 13\n      }\n    }, this.state.showlistening), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"microphone-btn\",\n      className: \"button\",\n      onClick: this.toggleListen,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: logo,\n      className: \"App-logo\",\n      alt: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"memo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 15\n      }\n    }, \"\\u4F60\\u53EF\\u4EE5\\u8AAA:\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 15\n      }\n    }, \"\\u300C\\u6253\\u958B\\u96FB\\u6E90\\u300D\\u4EE5\\u958B\\u555F\\u96FB\\u6E90\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, \"\\u300C\\u95DC\\u6389\\u96FB\\u6E90\\u300D\\u4EE5\\u95DC\\u9589\\u96FB\\u6E90\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clock\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 15\n      }\n    }, \"\\u73FE\\u5728\\u6642\\u9593\\u662F: \", this.state.time, \".\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"final\",\n      className: \"final\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"todolist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 15\n      }\n    }, \"\\u4ECA\\u65E5\\u6E05\\u55AE: \"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 15\n      }\n    }, \"\\u5373\\u5C07\\u5230\\u4F86:\", /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }\n    }, \"7/14, 1-1:30am, Csci150 TA intervew.\")))), /*#__PURE__*/React.createElement(MicIcon, {\n      fontSize: \"large\",\n      style: {\n        position: \"absolute\",\n        color: this.state.microphone,\n        top: 10,\n        right: 10\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 11\n      }\n    }));\n  }\n\n}\n\nexport default Speech;","map":{"version":3,"sources":["/Users/wan/foodplan/src/App.js"],"names":["React","Component","MicIcon","$","SpeechRecognition","window","webkitSpeechRecognition","recognition","continous","interimResults","lang","Speech","constructor","state","listening","showlistening","microphone","bgcolor","time","Date","toLocaleString","testbutton","toggleListen","bind","handleListen","componentDidMount","intervalID","setInterval","tick","setState","componentWillUnmount","clearInterval","console","log","start","onend","stop","onstart","intermiTranscript","onresult","event","finalTranscript","i","resultIndex","results","length","transcript","isFinal","ajax","url","dataType","jsonpCallback","data","success","result","alert","document","getElementById","innerHTML","transcriptArr","split","stopCmd","slice","setTimeout","finalText","join","onerror","error","render","backgroundColor","position","top","left","logo","color","right"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,OAAP,MAAoB,wBAApB;AACA,OAAOC,CAAP,MAAc,QAAd;;AAEA,OAAO,WAAP,C,CAGA;;AAEA,MAAMC,iBAAiB,GAAGC,MAAM,CAACC,uBAAP,IAAkCD,MAAM,CAACD,iBAAnE;AACA,MAAMG,WAAW,GAAG,IAAIH,iBAAJ,EAApB;AACAG,WAAW,CAACC,SAAZ,GAAwB,IAAxB;AACAD,WAAW,CAACE,cAAZ,GAA6B,IAA7B;AACAF,WAAW,CAACG,IAAZ,GAAmB,OAAnB,C,CAGA;;AAEA,MAAMC,MAAN,SAAqBV,SAArB,CAA+B;AAE7BW,EAAAA,WAAW,GAAG;AACZ;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,SAAS,EAAE,KADA;AAEXC,MAAAA,aAAa,EAAE,WAFJ;AAGXC,MAAAA,UAAU,EAAC,KAHA;AAIXC,MAAAA,OAAO,EAAC,SAJG;AAKXC,MAAAA,IAAI,EAAE,IAAIC,IAAJ,GAAWC,cAAX,EALK;AAMXC,MAAAA,UAAU,EAAC;AANA,KAAb;AAQA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACD;;AAEDE,EAAAA,iBAAiB,GAAG;AAClB,SAAKC,UAAL,GAAkBC,WAAW,CACzB,MAAM,KAAKC,IAAL,EADmB,EAEzB,IAFyB,CAA7B;AAID;;AACDN,EAAAA,YAAY,GAAG;AACb,SAAKO,QAAL,CAAc;AACZf,MAAAA,SAAS,EAAE,CAAC,KAAKD,KAAL,CAAWC;AADX,KAAd,EAEG,KAAKU,YAFR;AAGD;;AAEDM,EAAAA,oBAAoB,GAAG;AACrBC,IAAAA,aAAa,CAAC,KAAKL,UAAN,CAAb;AACD;;AAEDE,EAAAA,IAAI,GAAG;AACL,SAAKC,QAAL,CAAc;AACZX,MAAAA,IAAI,EAAE,IAAIC,IAAJ,GAAWC,cAAX;AADM,KAAd;AAGD;;AAEDI,EAAAA,YAAY,GAAG;AAEbQ,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B,KAAKpB,KAAL,CAAWC,SAArC;;AAEA,QAAI,KAAKD,KAAL,CAAWC,SAAf,EAA0B;AACxBP,MAAAA,WAAW,CAAC2B,KAAZ;;AACA3B,MAAAA,WAAW,CAAC4B,KAAZ,GAAoB,MAAM;AACxBH,QAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACA1B,QAAAA,WAAW,CAAC2B,KAAZ;AACD,OAHD;AAKD,KAPD,MAOO;AACL3B,MAAAA,WAAW,CAAC6B,IAAZ;;AACA7B,MAAAA,WAAW,CAAC4B,KAAZ,GAAoB,MAAM;AACxB,aAAKN,QAAL,CAAc;AACZb,UAAAA,UAAU,EAAC;AADC,SAAd;AAGAgB,QAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ;AACD,OALD;AAMD;;AAED1B,IAAAA,WAAW,CAAC8B,OAAZ,GAAsB,MAAM;AAC1BL,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA,WAAKJ,QAAL,CAAc;AACZZ,QAAAA,OAAO,EAAC,SADI;AAEZD,QAAAA,UAAU,EAAC;AAFC,OAAd;AAID,KAND;;AAQA,QAAIsB,iBAAiB,GAAG,EAAxB;;AACA/B,IAAAA,WAAW,CAACgC,QAAZ,GAAuBC,KAAK,IAAI;AAC9B,UAAIC,eAAe,GAAG,EAAtB;;AACA,WAAK,IAAIC,CAAC,GAAGF,KAAK,CAACG,WAAnB,EAAgCD,CAAC,GAAGF,KAAK,CAACI,OAAN,CAAcC,MAAlD,EAA0DH,CAAC,EAA3D,EAA+D;AAC7D,cAAMI,UAAU,GAAGN,KAAK,CAACI,OAAN,CAAcF,CAAd,EAAiB,CAAjB,EAAoBI,UAAvC;AACA,YAAIN,KAAK,CAACI,OAAN,CAAcF,CAAd,EAAiBK,OAArB,EAA8BT,iBAAiB,IAAIQ,UAAU,GAAG,GAAlC,CAA9B,KACKL,eAAe,IAAIK,UAAnB;AACN;;AACDd,MAAAA,OAAO,CAACC,GAAR,CAAYQ,eAAZ;;AACA,UAAIA,eAAe,KAAK,MAAxB,EAA+B;AAC7BT,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACA,aAAKJ,QAAL,CAAc;AACZZ,UAAAA,OAAO,EAAC,SADI;AAEZF,UAAAA,aAAa,EAAC;AAFF,SAAd;AAIAZ,QAAAA,CAAC,CAAC6C,IAAF,CAAO;AACLC,UAAAA,GAAG,EAAC,8EADC;AAELC,UAAAA,QAAQ,EAAE,OAFL;AAGLC,UAAAA,aAAa,EAAE,UAHV;AAILC,UAAAA,IAAI,EAAE;AAAC,sBAAS;AAAV,WAJD;AAKLC,UAAAA,OAAO,EAAC,UAASC,MAAT,EAAgB;AAACC,YAAAA,KAAK,CAACD,MAAD,CAAL;AAAc;AALlC,SAAP;AAOD,OAbD,MAcK,IAAGb,eAAe,KAAK,MAAvB,EAA8B;AACjCT,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACA,aAAKJ,QAAL,CAAc;AACZZ,UAAAA,OAAO,EAAC,SADI;AAEZF,UAAAA,aAAa,EAAC;AAFF,SAAd;AAIAZ,QAAAA,CAAC,CAAC6C,IAAF,CAAO;AACLC,UAAAA,GAAG,EAAC,+EADC;AAELC,UAAAA,QAAQ,EAAE,OAFL;AAGLC,UAAAA,aAAa,EAAE,UAHV;AAILC,UAAAA,IAAI,EAAE;AAAC,sBAAS;AAAV,WAJD;AAKLC,UAAAA,OAAO,EAAC,UAASC,MAAT,EAAgB;AAACC,YAAAA,KAAK,CAACD,MAAD,CAAL;AAAc;AALlC,SAAP;AAOD;;AAEDE,MAAAA,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCC,SAAjC,GAA6CjB,eAA7C,CArC8B,CAuC9B;;AAEA,YAAMkB,aAAa,GAAGlB,eAAe,CAACmB,KAAhB,CAAsB,SAAtB,CAAtB;AACA,YAAMC,OAAO,GAAGF,aAAa,CAACG,KAAd,CAAoB,CAAC,CAArB,EAAwB,CAAC,CAAzB,CAAhB;AACA9B,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuB4B,OAAvB;;AAEA,UAAIA,OAAO,CAAC,CAAD,CAAP,KAAe,MAAf,IAAyBA,OAAO,CAAC,CAAD,CAAP,KAAe,WAA5C,EAAwD;AACtDE,QAAAA,UAAU,CAACxD,WAAW,CAAC6B,IAAZ,EAAD,EAAoB,IAApB,CAAV;;AACA7B,QAAAA,WAAW,CAAC4B,KAAZ,GAAoB,MAAM;AACxBH,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACA,gBAAM+B,SAAS,GAAGL,aAAa,CAACG,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,EAA2BG,IAA3B,CAAgC,GAAhC,CAAlB;AACAT,UAAAA,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCC,SAAjC,GAA6CM,SAA7C;AACD,SAJD;AAKD;AACF,KArDD,CA9Ba,CAqFb;;;AAEAzD,IAAAA,WAAW,CAAC2D,OAAZ,GAAsB1B,KAAK,IAAI;AAC7BR,MAAAA,OAAO,CAACC,GAAR,CAAY,oCAAoCO,KAAK,CAAC2B,KAAtD;AACD,KAFD;AAID;;AAEDC,EAAAA,MAAM,GAAG;AACP,wBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAQ,MAAA,SAAS,EAAC,YAAlB;AAA+B,MAAA,KAAK,EAAE;AAACC,QAAAA,eAAe,EAAE,KAAKxD,KAAL,CAAWI;AAA7B,OAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,EAAE,EAAC,WAAR;AAAoB,MAAA,SAAS,EAAC,WAA9B;AAA0C,MAAA,KAAK,EAAE;AAACqD,QAAAA,QAAQ,EAAE,UAAX;AAAuBC,QAAAA,GAAG,EAAE,EAA5B;AAAgCC,QAAAA,IAAI,EAAE;AAAtC,OAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA6F,KAAK3D,KAAL,CAAWE,aAAxG,CADF,eAEE;AAAQ,MAAA,EAAE,EAAC,gBAAX;AAA4B,MAAA,SAAS,EAAC,QAAtC;AAA+C,MAAA,OAAO,EAAE,KAAKO,YAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,GAAG,EAAEmD,IAAV;AAAgB,MAAA,SAAS,EAAC,UAA1B;AAAqC,MAAA,GAAG,EAAC,MAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFF,eAKE;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4EAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4EAHF,CALF,eAUE;AAAK,MAAA,SAAS,EAAG,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CACU,KAAK5D,KAAL,CAAWK,IADrB,MADF,CAVF,eAeE;AAAK,MAAA,EAAE,EAAC,OAAR;AAAgB,MAAA,SAAS,EAAC,OAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAfF,eAgBE;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CADF,CAFF,CAhBF,CADF,eA0BE,oBAAC,OAAD;AAAS,MAAA,QAAQ,EAAC,OAAlB;AAA0B,MAAA,KAAK,EAAE;AAACoD,QAAAA,QAAQ,EAAC,UAAV;AAAsBI,QAAAA,KAAK,EAAC,KAAK7D,KAAL,CAAWG,UAAvC;AAAmDuD,QAAAA,GAAG,EAAC,EAAvD;AAA2DI,QAAAA,KAAK,EAAC;AAAjE,OAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA1BF,CADJ;AA+BD;;AAnK4B;;AAsK/B,eAAehE,MAAf","sourcesContent":["import React, { Component } from \"react\";\nimport MicIcon from '@material-ui/icons/Mic';\nimport $ from 'jquery';\nimport logo from './logo.svg';\nimport './App.css';\n\n\n//------------------------SPEECH RECOGNITION-----------------------------\n\nconst SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition;\nconst recognition = new SpeechRecognition();\nrecognition.continous = true\nrecognition.interimResults = true\nrecognition.lang = 'zh-TW'\n\n\n//------------------------COMPONENT-----------------------------\n\nclass Speech extends Component {\n\n  constructor() {\n    super()\n    this.state = {\n      listening: false,\n      showlistening: \"Power Off\",\n      microphone:\"red\",\n      bgcolor:'#282c34',\n      time: new Date().toLocaleString(),\n      testbutton:\"red\"\n    }\n    this.toggleListen = this.toggleListen.bind(this)\n    this.handleListen = this.handleListen.bind(this)\n  }\n\n  componentDidMount() {\n    this.intervalID = setInterval(\n        () => this.tick(),\n        1000\n    );\n  }\n  toggleListen() {\n    this.setState({\n      listening: !this.state.listening\n    }, this.handleListen)\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.intervalID);\n  }\n\n  tick() {\n    this.setState({\n      time: new Date().toLocaleString()\n    });\n  }\n\n  handleListen() {\n\n    console.log('listening?', this.state.listening)\n\n    if (this.state.listening) {\n      recognition.start()\n      recognition.onend = () => {\n        console.log(\"...continue listening...\")\n        recognition.start()\n      }\n\n    } else {\n      recognition.stop()\n      recognition.onend = () => {\n        this.setState({\n          microphone:\"red\"\n        })\n        console.log(\"Stopped listening per click\")\n      }\n    }\n\n    recognition.onstart = () => {\n      console.log(\"Listening!\")\n      this.setState({\n        bgcolor:'#282c34',\n        microphone:\"green\"\n      })\n    }\n\n    let intermiTranscript = ''\n    recognition.onresult = event => {\n      let finalTranscript = ''\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        const transcript = event.results[i][0].transcript;\n        if (event.results[i].isFinal) intermiTranscript += transcript + ' ';\n        else finalTranscript += transcript;\n      }\n      console.log(finalTranscript)\n      if (finalTranscript === \"打開電源\"){\n        console.log(\"指令成功！\")\n        this.setState({\n          bgcolor:'#006400',\n          showlistening:\"Power On\"\n        })\n        $.ajax({\n          url:\"https://maker.ifttt.com/trigger/ricecookeron/with/key/dyMeTmyKz4_uQNNPyqZABx\",\n          dataType: 'JSONP',\n          jsonpCallback: 'callback',\n          data: {\"value1\":\"rice cooker on\"},\n          success:function(result){alert(result)}\n        })\n      }\n      else if(finalTranscript === \"關掉電源\"){\n        console.log(\"指令成功！\")\n        this.setState({\n          bgcolor:'#006400',\n          showlistening:\"Power Off\"\n        })\n        $.ajax({\n          url:\"https://maker.ifttt.com/trigger/ricecookeroff/with/key/dyMeTmyKz4_uQNNPyqZABx\",\n          dataType: 'JSONP',\n          jsonpCallback: 'callback',\n          data: {\"value1\":\"rice cooker off\"},\n          success:function(result){alert(result)}\n        })\n      }\n\n      document.getElementById('final').innerHTML = finalTranscript\n\n      //-------------------------COMMANDS------------------------------------\n\n      const transcriptArr = finalTranscript.split('OKOKOK ')\n      const stopCmd = transcriptArr.slice(-3, -1)\n      console.log('stopCmd', stopCmd)\n\n      if (stopCmd[0] === 'stop' && stopCmd[1] === 'listening'){\n        setTimeout(recognition.stop(),8000)\n        recognition.onend = () => {\n          console.log('Stopped listening per command')\n          const finalText = transcriptArr.slice(0, -3).join(' ')\n          document.getElementById('final').innerHTML = finalText\n        }\n      }\n    }\n\n    //-----------------------------------------------------------------------\n\n    recognition.onerror = event => {\n      console.log(\"Error occurred in recognition: \" + event.error)\n    }\n\n  }\n\n  render() {\n    return (\n        <div>\n          <header className=\"App-header\" style={{backgroundColor: this.state.bgcolor}}>\n            <div id='listening' className='listening' style={{position: \"absolute\", top: 10, left: 10}}>{this.state.showlistening}</div>\n            <button id='microphone-btn' className=\"button\" onClick={this.toggleListen}>\n              <img src={logo} className=\"App-logo\" alt=\"logo\"/>\n            </button>\n            <div className='memo'>\n              <p>你可以說:</p>\n              <p>「打開電源」以開啟電源</p>\n              <p>「關掉電源」以關閉電源</p>\n            </div>\n            <div className = 'clock'>\n              <p>\n                現在時間是: {this.state.time}.\n              </p>\n            </div>\n            <div id='final' className=\"final\"></div>\n            <div className='todolist'>\n              <p>今日清單: </p>\n              <p>即將到來:\n                <p>7/14, 1-1:30am, Csci150 TA intervew.</p>\n              </p>\n            </div>\n          </header>\n\n\n          <MicIcon fontSize=\"large\" style={{position:\"absolute\", color:this.state.microphone, top:10, right:10}}/>\n        </div>\n\n    )\n  }\n}\n\nexport default Speech\n"]},"metadata":{},"sourceType":"module"}